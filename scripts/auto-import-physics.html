<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Auto Import Physics</title>
  <style>
    body { 
      font-family: monospace; 
      padding: 20px; 
      background: #000; 
      color: #0f0; 
    }
    .status { margin: 5px 0; }
    .success { color: #0f0; }
    .error { color: #f00; }
  </style>
</head>
<body>
  <h1>Automatick√Ω import fyziky</h1>
  <div id="output"></div>

  <script>
    const EDGE_FUNCTION_URL = 'https://jcabdfmvjblzulnvvuso.supabase.co/functions/v1/import-2lf-questions';
    
    const files = [
      { path: '/data/2lf/Atomov√°_fyzika.md', category: 'Atomov√° fyzika' },
      { path: '/data/2lf/Elekt≈ôina_a_magnetismus.md', category: 'Elekt≈ôina a magnetismus' },
      { path: '/data/2lf/Elektromagnetick√©_vlnƒõn√≠.md', category: 'Elektromagnetick√© vlnƒõn√≠' },
      { path: '/data/2lf/Kmit√°n√≠_vlnƒõn√≠_a_akustika.md', category: 'Kmit√°n√≠ vlnƒõn√≠ a akustika' },
      { path: '/data/2lf/Molekulov√°_fyzika.md', category: 'Molekulov√° fyzika' },
      { path: '/data/2lf/Optika.md', category: 'Optika' },
      { path: '/data/2lf/Termika.md', category: 'Termika' }
    ];

    function log(message, isError = false) {
      const output = document.getElementById('output');
      const div = document.createElement('div');
      div.className = `status ${isError ? 'error' : 'success'}`;
      div.textContent = `${new Date().toLocaleTimeString()}: ${message}`;
      output.appendChild(div);
      console.log(message);
    }

    async function importPhysics() {
      log('üöÄ Zahajuji import fyzik√°ln√≠ch ot√°zek...');
      
      try {
        const fileContents = [];
        
        for (const file of files) {
          log(`üìñ Naƒç√≠t√°m ${file.category}...`);
          const response = await fetch(file.path);
          if (!response.ok) {
            throw new Error(`Nepoda≈ôilo se naƒç√≠st ${file.category}`);
          }
          const content = await response.text();
          fileContents.push({ content, categoryName: file.category });
          log(`‚úì Naƒçteno ${file.category} (${content.length} znak≈Ø)`);
        }
        
        log('üíæ Odes√≠l√°m do datab√°ze...');
        
        const response = await fetch(EDGE_FUNCTION_URL, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json; charset=UTF-8'
          },
          body: JSON.stringify({ fileContents })
        });
        
        if (!response.ok) {
          const error = await response.text();
          throw new Error(`Chyba edge function: ${error}`);
        }
        
        const data = await response.json();
        
        log('‚úÖ Import dokonƒçen!');
        
        if (data.results) {
          data.results.forEach(result => {
            if (result.error) {
              log(`‚ùå ${result.category}: ${result.error}`, true);
            } else {
              log(`‚úì ${result.category}: ${result.questionsImported} ot√°zek naimportov√°no`);
            }
          });
        }
        
        log('üéâ V≈°e hotovo!');
        
      } catch (error) {
        log(`‚ùå Chyba: ${error.message}`, true);
        console.error('Import error:', error);
      }
    }

    // Auto-start on page load
    window.addEventListener('DOMContentLoaded', importPhysics);
  </script>
</body>
</html>
